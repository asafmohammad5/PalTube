(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{53:function(e,t,a){e.exports=a(75)},75:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(42),s=a.n(i),l=a(26),o=a(11),c=a(10),m=a(25),u=a(5),d=a(6),v=a(8),p=a(7),h=a(9),E=a(13),f=a(14),g=a.n(f);function b(){var e=Object(E.a)(["\n    query FetchUserFavoriteVideos($id: ID!) {\n      user(_id: $id){\n        _id, username\n      favoriteVideos{\n        _id, title, url, description\n        comments{\n          _id\n        }\n        favoriteBy{\n          _id\n        }\n      }\n      }\n    }\n  "]);return b=function(){return e},e}function y(){var e=Object(E.a)(["\n    query FetchUserLikedVideos($id: ID!) {\n      user(_id: $id){\n        _id\n        videos_liked{\n          _id\n          title\n          url\n          description\n        comments{\n          _id\n        }\n        favoriteBy{\n          _id\n        }\n        }\n      }\n    }\n  "]);return y=function(){return e},e}function k(){var e=Object(E.a)(["\n    query FetchVideoLikes($id: ID!) {\n      video(_id: $id){ \n        likes {\n          _id\n          username\n        }\n      }\n    }\n  "]);return k=function(){return e},e}function I(){var e=Object(E.a)(["\n  query filterVideos($criteria: String){\n  videos(criteria: $criteria){\n      _id\n      title\n      description\n      category\n      url\n      keywords\n      comments{\n        _id\n      }\n      favoriteBy{\n        _id\n      }\n    }\n  }\n\n "]);return I=function(){return e},e}function O(){var e=Object(E.a)(["\n  query FetchComment($id: ID!){\n  comment (_id: $id) {\n    _id\n    text\n    date\n    gif\n    author {\n      username\n      image\n    }\n    date\n    replies {\n      _id\n      text\n      date\n      gif\n      author {\n        username\n        image\n      }\n    }\n  }\n}\n"]);return O=function(){return e},e}function N(){var e=Object(E.a)(["\n  query queryVideo($id:ID!){\n  video(_id:$id){\n     _id\n    title\n    description\n    category\n    url\n    likes {\n      _id\n    }\n    dislikes {\n      _id\n    }\n    keywords\n    comments {\n      _id\n      text\n      date\n      gif\n      author {\n        username\n        image\n      }\n      replies {\n        _id\n        text\n        date\n        gif\n        author {\n          username\n          image\n        }\n      }\n    }\n    favoriteBy{\n      _id\n    }\n     }\n    }\n  "]);return N=function(){return e},e}function S(){var e=Object(E.a)(["\n    query IsUserLoggedIn {\n      isLoggedIn @client\n    }\n  "]);return S=function(){return e},e}var _={IS_LOGGED_IN:g()(S()),FETCH_VIDEO:g()(N()),FETCH_COMMENT:g()(O()),FETCH_VIDEOS:g()(I()),FETCH_VIDEO_LIKES:g()(k()),FETCH_USER_LIKED_VIDEOS:g()(y()),FETCH_USER_FAVORITE_VIDEOS:g()(b())},w=a(77),C=function(){return JSON.parse(localStorage.getItem("user"))};window.addEventListener("DOMContentLoaded",(function(e){var t="dark"===localStorage.getItem("theme")?window.darkTheme:window.lightTheme;document.getElementById("site-logo")&&(document.getElementById("site-logo").src=t)}));var j=function(){var e=localStorage.getItem("theme"),t=document.createElement("link");t.href="dark"!==e?"../stylesheets/components/light_theme.css":"../stylesheets/components/dark_theme.css",t.rel="stylesheet",t.type="text/css",document.body.appendChild(t),function(){var e="dark"===localStorage.getItem("theme")?window.darkTheme:window.lightTheme;document.getElementById("site-logo")&&(document.getElementById("site-logo").src=e)}()},D=function(){return localStorage.getItem("theme")},L=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).changeTheme=function(e){var t=e.target.checked?"dark":"light";localStorage.setItem("theme",t),j()},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){document.getElementById("chkTheme").checked="dark"===D()}},{key:"render",value:function(){var e=C()?C().image:"/stylesheets/images/default_avatar_2.png",t=C()?C().username:"guest";return r.a.createElement("aside",{className:"sidebar hide"},r.a.createElement("div",{className:"sidebar-user-info"},r.a.createElement("img",{src:e,className:"sidebar-avatar",alt:t}),r.a.createElement("p",{className:"sidebar-username"},t),r.a.createElement("label",{className:"switch"},r.a.createElement("input",{id:"chkTheme",type:"checkbox",onChange:this.changeTheme}),">",r.a.createElement("span",{className:"slider"}))),r.a.createElement("hr",null),r.a.createElement("ul",null,r.a.createElement("li",{className:"clickable sidebar-section-header"},r.a.createElement(c.b,{to:"/"},r.a.createElement("i",{className:"fas fa-home"},"\xa0"),r.a.createElement("span",{className:""},"Home"))),C()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"clickable sidebar-section-header"},r.a.createElement("i",{className:"far fa-thumbs-up"},"\xa0"),r.a.createElement(c.b,{to:"/videos/likes",className:""},"Liked Videos")),r.a.createElement("li",{className:"clickable sidebar-section-header"},r.a.createElement("i",{className:"fas fa-hand-holding-heart"},"\xa0"),r.a.createElement(c.b,{to:"/videos/favorites"},"Favorite Videos"))),r.a.createElement("li",{className:"sidebar-section-header"},r.a.createElement("i",{className:"fas fa-th-list"},"\xa0"),r.a.createElement("span",null,"Categories")),r.a.createElement("li",{className:"sidebar-item clickable"},r.a.createElement("i",{className:"fas fa-cat"},"\xa0"),r.a.createElement(c.b,{to:"/search/cats"},"Funny Cats")),r.a.createElement("li",{className:"sidebar-item clickable"},r.a.createElement("i",{className:"fas fa-dog"},"\xa0"),r.a.createElement(c.b,{to:"/search/dog"},"Funny Dogs")),r.a.createElement("li",{className:"sidebar-item clickable"},r.a.createElement("i",{className:"fas fa-child"},"\xa0"),r.a.createElement(c.b,{to:"/search/kids"},"kids")),r.a.createElement("li",{className:"sidebar-item clickable"},r.a.createElement("i",{className:"fas fa-dove"},"\xa0"),r.a.createElement(c.b,{to:"/search/birds"},"birds")),r.a.createElement("li",{className:"sidebar-item clickable"},r.a.createElement("i",{className:"fas fa-horse"},"\xa0"),r.a.createElement(c.b,{to:"/search/horse"},"horses"))))}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).changeTheme=function(e){var t=e.target.checked?"dark":"light";localStorage.setItem("theme",t),j()},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){document.getElementById("chkTheme").checked="dark"===D()}},{key:"render",value:function(){return r.a.createElement("aside",{className:"mini-sidebar show"},r.a.createElement("ul",null,r.a.createElement("li",{className:"clickable mini-sidebar-section-header"},r.a.createElement(c.b,{to:"/"},r.a.createElement("i",{className:"fas fa-home mini-icon"},"\xa0"),r.a.createElement("p",{className:"mini-description"},"Home"))),C()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"clickable mini-sidebar-section-header"},r.a.createElement(c.b,{to:"/videos/likes",className:""},r.a.createElement("i",{className:"far fa-thumbs-up mini-icon"},"\xa0"),r.a.createElement("p",{className:"mini-description"},"My Likes"))),r.a.createElement("li",{className:"clickable mini-sidebar-section-header"},r.a.createElement(c.b,{to:"/videos/favorites"},r.a.createElement("i",{className:"fas fa-hand-holding-heart mini-icon"},"\xa0"),r.a.createElement("p",{className:"mini-description"},"Favorites"))))))}}]),t}(n.Component),V=a(33),T=_.IS_LOGGED_IN,F=function(e){return r.a.createElement(o.a,null,(function(e){return r.a.createElement(V.b,{query:T},(function(t){if(t.data.isLoggedIn){var a=C()?C().image:"/stylesheets/images/default_avatar_2.png",n=C()?C().email:"",i=C()?C().username:"";return r.a.createElement("div",{className:"navbar-logout",onClick:function(e){return function(e){e.preventDefault();var t=document.getElementById("navLogoutPopup");t&&t.classList.toggle("display")}(e)}},r.a.createElement("img",{alt:"PalTube",src:a,className:"navbar-pic"}),r.a.createElement("div",{className:"navPopup",id:"navLogoutPopup"},r.a.createElement("div",{className:"logout-info"},r.a.createElement("p",{className:"nav-popup-username"},i),r.a.createElement("p",{className:"nav-popup-email"},n)),r.a.createElement("div",{className:"logout-likes"},r.a.createElement(c.b,{to:"/videos/likes"},r.a.createElement("i",{className:"fas fa-thumbs-up sign-out-icon"}),"My Likes")),r.a.createElement("button",{className:"logout-button",onClick:function(t){t.preventDefault(),localStorage.removeItem("auth-token"),localStorage.removeItem("user"),e.writeData({data:{isLoggedIn:!1}})}},r.a.createElement(c.b,{to:"/",className:"nav-log-out"},r.a.createElement("i",{className:"fas fa-sign-out-alt sign-out-icon"}),"Sign Out"))))}return r.a.createElement("div",{className:"nav-links"},r.a.createElement(c.b,{to:"/register",className:"nav-sign-up"},"SIGN UP"),r.a.createElement(c.b,{to:"/login",className:"nav-sign-in"},"SIGN IN"))}))}))},$=a(48),U=a.n($),R=[{name:"cat",value:1},{name:"cats",value:2},{name:"funny cat",value:3},{name:"dog",value:4},{name:"dogs",value:5},{name:"funny dog",value:6},{name:"funny dogs",value:7},{name:"animals",value:8},{name:"baby",value:9},{name:"babies",value:10},{name:"puppies",value:11},{name:"kid",value:12},{name:"kids",value:13},{name:"kids and animals",value:14},{name:"trolling",value:15},{name:"birds",value:16},{name:"birds talk like human",value:17},{name:"horse",value:18},{name:"horses",value:19},{name:"funny horse",value:20},{name:"horses are much more funny than cats",value:21},{name:"cute and funny horse",value:22},{name:"funnies horse",value:23}],q=function(e){var t=e.trim().toLowerCase();return 0===t.length?[]:R.filter((function(e){return e.name.toLocaleLowerCase().includes(t)}))},M=function(e){return e.name},Q=function(e){return r.a.createElement("div",null,e.name)},A=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(v.a)(this,Object(p.a)(t).call(this))).handleKeydown=function(t){"react-autowhatever-txtSearchVideos"===t.target.getAttribute("aria-controls")&&("Enter"!==t.key&&13!==t.keyCode||(window.location.href="#/search/".concat(e.state.value)))},e.handleSearchClick=function(t){"searchBtn"===t.target.id&&(window.location.href="#/search/".concat(e.state.value))},e.onSuggestionsFetchRequested=function(t){var a=t.value;e.setState({suggestions:q(a)})},e.onSuggestionsClearRequested=function(){e.setState({suggestions:[]})},e.onChange=function(t,a){var n=a.newValue;a.method;e.setState({value:n})},e.state={value:"",suggestions:[],referrer:null},e}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.suggestions,n={placeholder:"search...",value:t,onChange:this.onChange};return r.a.createElement("div",{id:"div",style:{display:"flex"}},r.a.createElement(U.a,{id:"txtSearchVideos",suggestions:a,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:M,renderSuggestion:Q,inputProps:n,highlightFirstSuggestion:!0}),r.a.createElement("button",{className:"clickable search-icon",onClick:this.handleSearchClick},r.a.createElement("i",{className:"fas fa-search",id:"searchBtn"})))}}]),t}(n.Component),H=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(v.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).toggleMenu=function(){var e=document.getElementsByClassName("sidebar")[0],t=document.getElementsByClassName("mini-sidebar")[0],a=e.classList.contains("show")?"hide":"show",n=t.classList.contains("show")?"hide":"show";t.classList.remove("show"),t.classList.remove("hide"),t.classList.add(n),e.classList.remove("show"),e.classList.remove("hide"),e.classList.add(a)},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){localStorage.getItem("theme")?j():(localStorage.setItem("theme","dark"),j());var e="dark"===localStorage.theme?window.darkTheme:window.lightTheme;return r.a.createElement("div",{className:"navbar"},r.a.createElement("div",{className:"logo-container"},r.a.createElement("span",{onClick:this.toggleMenu,className:"burger-menu-icon",id:"nav-toggle"},"\u2630"),r.a.createElement(c.b,{to:"/"},r.a.createElement("img",{id:"site-logo",className:"navbar-logo",src:e,alt:"Paltube"}))),r.a.createElement(A,null),r.a.createElement(F,null))}}]),t}(n.Component),P=_.FETCH_VIDEOS,B=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderVideos",value:function(){return this.props.data.videos.map((function(e){var t=e._id,a=e.title,n=e.url;return r.a.createElement("div",{key:t,className:"video-container"},r.a.createElement("div",null,r.a.createElement("object",{className:"video-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0}))),r.a.createElement("div",{className:"video-info"},r.a.createElement(c.b,{to:"/videos/".concat(t)},r.a.createElement("p",{className:"video-title clickable"},a))))}))}},{key:"render",value:function(){return this.props.data.loading||!this.props.data.videos?null:r.a.createElement("div",null,r.a.createElement(H,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"flex-grid"},r.a.createElement(x,null),r.a.createElement(L,null),r.a.createElement("section",{className:"main"},r.a.createElement("h3",null,"Recommended Videos"),r.a.createElement("div",{className:"row"},this.renderVideos())))))}}]),t}(n.Component),G=Object(w.a)(P)(B),K=a(21);function Y(){var e=Object(E.a)(["\n    mutation RemoveFromFavorites($videoId: ID!, $userId: ID!) {\n      removeFavoriteVideo(videoId: $videoId, userId:$userId){\n      _id\n    }\n  }\n  "]);return Y=function(){return e},e}function z(){var e=Object(E.a)(["\n    mutation AddToFavorites($videoId: ID!, $userId: ID!) {\n      addFavoriteVideo(videoId: $videoId, userId:$userId){\n      _id\n    }\n  }\n  "]);return z=function(){return e},e}function J(){var e=Object(E.a)(["\n    mutation VideoRemoveDislike($videoId: ID!, $userId: ID!) {\n      removeVideoDislike(videoId: $videoId, userId: $userId) {\n        _id\n      }\n    }\n  "]);return J=function(){return e},e}function Z(){var e=Object(E.a)(["\n    mutation VideoDislike($videoId: ID!, $userId: ID!) {\n      addVideoDislike(videoId: $videoId, userId: $userId) {\n        _id\n      }\n    }\n  "]);return Z=function(){return e},e}function W(){var e=Object(E.a)(["\n    mutation VideoRemoveLike($videoId: ID!, $userId: ID!) {\n      removeVideoLike(videoId: $videoId, userId: $userId) {\n        _id\n      }\n    }\n  "]);return W=function(){return e},e}function X(){var e=Object(E.a)(["\n    mutation VideoLike($videoId: ID!, $userId: ID!) {\n      addVideoLike(videoId: $videoId, userId: $userId) {\n        _id\n      }\n    }\n  "]);return X=function(){return e},e}function ee(){var e=Object(E.a)(["\n  mutation UpdateComment($id: ID!, $text: String) {\n    updateComment(id: $id, text: $text) {\n      _id\n      text\n      date\n      author {\n        username\n        image\n      }\n      replies {\n        _id\n       }\n    }\n  }\n"]);return ee=function(){return e},e}function te(){var e=Object(E.a)(["\n    mutation DeleteComment($id: ID!) {\n      deleteComment(id: $id) {\n        _id\n      }\n    }\n  "]);return te=function(){return e},e}function ae(){var e=Object(E.a)(["\n    mutation ReplyComment($text: String!, $author: ID!, $parentCommentId: ID!, $gif: String!) {\n      addReplyComment(text: $text, author: $author, parentCommentId: $parentCommentId, gif: $gif) {\n        _id\n        text\n        author {\n          username\n          image\n        }\n        replies {\n          _id  \n        }\n        date\n        gif\n      }\n    }\n  "]);return ae=function(){return e},e}function ne(){var e=Object(E.a)(["\n    mutation VideoComment($text: String!, $author: ID!, $videoId: ID!, $gif: String!) {\n      addVideoComment(text: $text, author: $author, videoId: $videoId, gif: $gif) {\n        _id\n        text\n        author {\n          username\n          image\n        }\n        replies {\n          _id  \n        }\n        date\n        gif\n      }\n    }\n  "]);return ne=function(){return e},e}function re(){var e=Object(E.a)(["\n  mutation VerifyUser($token: String!) {\n    verifyUser(token: $token) {\n      loggedIn\n    }\n  }\n"]);return re=function(){return e},e}function ie(){var e=Object(E.a)(["\n  mutation RegisterUser($username: String!, $email: String!, $password: String!, $password2: String!, $image:String!) {\n    register(username: $username, email: $email, password: $password, password2: $password2, image: $image) {\n      email\n      token\n      loggedIn\n      _id\n      username\n      image\n    }\n  }\n "]);return ie=function(){return e},e}function se(){var e=Object(E.a)(["\n  mutation LoginUser($emailOrUsername: String!, $password: String!) {\n    login(emailOrUsername: $emailOrUsername, password: $password) {\n      token\n      loggedIn\n      _id\n      email\n      username\n      image\n    }\n  }\n  "]);return se=function(){return e},e}var le={LOGIN_USER:g()(se()),REGISTER_USER:g()(ie()),VERIFY_USER:g()(re()),VIDEO_COMMENT:g()(ne()),REPLY_COMMENT:g()(ae()),DELETE_COMMENT:g()(te()),UPDATE_COMMENT:g()(ee()),ADD_VIDEO_LIKE:g()(X()),REMOVE_VIDEO_LIKE:g()(W()),ADD_VIDEO_DISLIKE:g()(Z()),REMOVE_VIDEO_DISLIKE:g()(J()),ADD_TO_FAVORITES:g()(z()),REMOVE_FROM_FAVORITES:g()(Y())},oe=a(29),ce=a.n(oe),me=le.REPLY_COMMENT,ue=_.FETCH_VIDEO,de=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={text:"@"+a.props.user,gif:"",error:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){t.setState(Object(K.a)({},e,a.target.value))}}},{key:"handleSubmit",value:function(e,t){var a=this;e.preventDefault();var n=this.state.text,r=this.state.gif;this.state.text!=="@"+this.props.user?t({variables:{text:n,author:C().id,parentCommentId:this.props.parentId,gif:r}}).then((function(e){a.setState({text:"@"+a.props.user,gif:"",error:""})})):this.setState({error:"cannot be empty"})}},{key:"updateCache",value:function(e,t){var a,n=t.data.addReplyComment;try{a=e.readQuery({query:ue,variables:{id:this.props.videoId}})}catch(s){return}if(a){for(var r=(a=Object.assign({},a.video)).comments,i=0;i<r.length;i++)this.props.parentId===r[i]._id&&r[i].replies.push(n);e.writeQuery({query:ue,variables:{id:this.props.videoId},data:{video:a}})}}},{key:"updategif",value:function(e){this.setState({gif:e.downsized.url})}},{key:"render",value:function(){var e,t=this;return C()?C().username!==this.props.user?("cannot be empty"===this.state.error&&(e="Comment must have text"),r.a.createElement(V.a,{onError:function(e){t.setState({error:e.message})},mutation:me,update:function(e,a){return t.updateCache(e,a)}},(function(a,n){n.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){return t.handleSubmit(e,a)}},r.a.createElement("textarea",{value:t.state.text,onChange:t.update("text"),placeholder:"Commenting publicly as ".concat(C().username)}),r.a.createElement("div",null,e),r.a.createElement("button",{type:"submit"},"Reply")),r.a.createElement("div",{className:"giphy-reply"}," ",r.a.createElement(ce.a,{apiKey:"EeZhW081PZQ2Abce60Y4EQulHVTzcbRA",onSelected:t.updategif.bind(t)})))}))):r.a.createElement("div",null):r.a.createElement("textarea",{value:this.state.text,onChange:this.update("text"),placeholder:"Must Be Signed In to Comment"})}}]),t}(r.a.Component),ve=_.FETCH_VIDEO,pe=le.DELETE_COMMENT,he=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleSubmit",value:function(e,t){e.preventDefault(),t({variables:{id:this.props.commentId}})}},{key:"render",value:function(){var e=this;return C()&&this.props.user===C().username?r.a.createElement(V.a,{mutation:pe,refetchQueries:function(){return[{query:ve,variables:{id:e.props.videoId}}]}},(function(t,a){a.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(a){return e.handleSubmit(a,t)}},r.a.createElement("button",{type:"submit"},"Delete")))})):r.a.createElement("div",null)}}]),t}(r.a.Component),Ee=_.FETCH_VIDEO,fe=le.UPDATE_COMMENT,ge=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={text:a.props.comment.text},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){t.setState(Object(K.a)({},e,a.target.value))}}},{key:"handleSubmit",value:function(e,t){e.preventDefault(),t({variables:{id:this.props.comment._id,text:this.state.text}})}},{key:"render",value:function(){var e=this;return C()&&this.props.comment.author.username===C().username?r.a.createElement(V.a,{mutation:fe,refetchQueries:function(){return[{query:Ee,variables:{id:e.props.videoId}}]}},(function(t,a){a.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(a){return e.handleSubmit(a,t)}},r.a.createElement("textarea",{value:e.state.text,onChange:e.update("text")}),r.a.createElement("button",{className:"edit-button",type:"submit"},"Edit")))})):r.a.createElement("div",null)}}]),t}(r.a.Component),be=function(e){var t=new Date(+e.comment.date),a=t.getFullYear(),n=t.getMonth(),i=t.getDate(),s=e.comment.author.image?e.comment.author.image:"/stylesheets/images/default_avatar_2.png",l=e.comment.gif?r.a.createElement("img",{alt:"comment",className:"main-comment-gif",src:e.comment.gif}):null;return r.a.createElement("div",{className:"reply-comment-index"},r.a.createElement("div",{className:"main-comment-top"},r.a.createElement("img",{src:s,className:"comment-create-avatar"}),r.a.createElement("div",{className:"main-comment-name"},e.comment.author.username),r.a.createElement("div",{className:"main-comment-year"},a+"-"+n+"-"+i)),r.a.createElement("div",{className:"main-comment-text"},e.comment.text),l,r.a.createElement("div",{className:"comment-reply-reply"},r.a.createElement(de,{videoId:e.videoId,parentId:e.parentId,user:e.comment.author.username})),r.a.createElement("br",null),r.a.createElement("div",{className:"comment-index-item-delete"},r.a.createElement(he,{commentId:e.comment._id,videoId:e.videoId,user:e.comment.author.username})),r.a.createElement("div",{className:"comment-index-item-edit"},r.a.createElement(ge,{videoId:e.videoId,comment:e.comment})))},ye=_.FETCH_VIDEO,ke=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(V.b,{query:ye,variables:{id:this.props.videoId}},(function(t){var a=t.loading,n=t.error,i=t.data;if(a)return r.a.createElement("p",null,"Loading...");if(n)return r.a.createElement("p",null,"Error");for(var s,l=i.video.comments,o=0;o<l.length;o++)e.props.commentId===l[o]._id&&(s=l[o].replies);var c=s.map((function(t){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(be,{comment:t,videoId:e.props.videoId,parentId:e.props.commentId})," "))}));return r.a.createElement("div",null,c)}))}}]),t}(r.a.Component),Ie=le.REPLY_COMMENT,Oe=_.FETCH_VIDEO,Ne=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={text:"",gif:"",error:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){t.setState(Object(K.a)({},e,a.target.value))}}},{key:"handleSubmit",value:function(e,t){var a=this;e.preventDefault();var n=this.state.text,r=this.state.gif;""!==this.state.text?t({variables:{text:n,author:C().id,parentCommentId:this.props.parentId,gif:r}}).then((function(e){a.setState({text:"",gif:"",error:""})})):this.setState({error:"GraphQL error: Cannot return null for non-nullable field CommentType.text."})}},{key:"updateCache",value:function(e,t){var a,n=t.data.addReplyComment;try{a=e.readQuery({query:Oe,variables:{id:this.props.videoId}})}catch(s){return}if(a){for(var r=(a=Object.assign({},a.video)).comments,i=0;i<r.length;i++)this.props.parentId===r[i]._id&&r[i].replies.push(n);e.writeQuery({query:Oe,variables:{id:this.props.videoId},data:{video:a}})}}},{key:"updategif",value:function(e){this.setState({gif:e.downsized.url})}},{key:"render",value:function(){var e,t=this;return C()?("GraphQL error: Cannot return null for non-nullable field CommentType.text."===this.state.error&&(e="Comment must have text"),r.a.createElement(V.a,{onError:function(e){t.setState({error:e.message})},mutation:Ie,update:function(e,a){return t.updateCache(e,a)}},(function(a,n){n.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){return t.handleSubmit(e,a)}},r.a.createElement("textarea",{value:t.state.text,onChange:t.update("text"),placeholder:"Commenting publicly as ".concat(C().username)}),r.a.createElement("div",null,e),r.a.createElement("button",{type:"submit"},"Reply")),r.a.createElement("div",{className:"giphy-comment"}," ",r.a.createElement(ce.a,{apiKey:"EeZhW081PZQ2Abce60Y4EQulHVTzcbRA",onSelected:t.updategif.bind(t)})))}))):r.a.createElement("textarea",{value:this.state.text,onChange:this.update("text"),placeholder:"Must Be Signed In to Comment"})}}]),t}(r.a.Component),Se=_.FETCH_VIDEO,_e=le.UPDATE_COMMENT,we=le.DELETE_COMMENT,Ce=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleSubmit",value:function(e,t){e.preventDefault(),t({variables:{id:this.props.commentId,text:"!(!DELETE!)!"}})}},{key:"handleSubmit2",value:function(e,t){e.preventDefault(),t({variables:{id:this.props.commentId}})}},{key:"render",value:function(){var e=this;return C()?this.props.user===C().username&&this.props.comment.replies.length>0?r.a.createElement(V.a,{mutation:_e,refetchQueries:function(){return[{query:Se,variables:{id:e.props.videoId}}]}},(function(t,a){a.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(a){return e.handleSubmit(a,t)}},r.a.createElement("button",{type:"submit"},"Delete")))})):this.props.user===C().username?r.a.createElement(V.a,{mutation:we,refetchQueries:function(){return[{query:Se,variables:{id:e.props.videoId}}]}},(function(t,a){a.data;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(a){return e.handleSubmit2(a,t)}},r.a.createElement("button",{type:"submit"},"Delete")))})):r.a.createElement("div",null):r.a.createElement("div",null)}}]),t}(r.a.Component),je=function(e){var t=new Date(+e.comment.date),a=t.getFullYear(),n=t.getMonth(),i=t.getDate(),s=e.comment.author.image?e.comment.author.image:"/stylesheets/images/default_avatar_2.png",l=e.comment.gif?r.a.createElement("img",{alt:e.comment.text,className:"main-comment-gif",src:e.comment.gif}):null;return"!(!DELETE!)!"!==e.comment.text?r.a.createElement("div",{className:"main-comment-index"},r.a.createElement("div",{className:"main-comment-top"},r.a.createElement("img",{src:s,className:"comment-create-avatar"}),r.a.createElement("div",{className:"main-comment-name"},e.comment.author.username),r.a.createElement("div",{className:"main-comment-year"},a+"-"+n+"-"+i)),r.a.createElement("div",{className:"main-comment-text"},e.comment.text),l,r.a.createElement("div",{className:"comment-index-reply"},r.a.createElement(Ne,{parentId:e.comment._id,videoId:e.videoId})),r.a.createElement("div",{className:"comment-index-item-delete"},r.a.createElement(Ce,{comment:e.comment,commentId:e.comment._id,videoId:e.videoId,user:e.comment.author.username})),r.a.createElement("div",{className:"comment-index-item-edit"},r.a.createElement(ge,{videoId:e.videoId,comment:e.comment})),r.a.createElement("div",{className:"comment-reply-index"},r.a.createElement(ke,{commentId:e.comment._id,videoId:e.videoId}))):r.a.createElement("div",null,r.a.createElement("div",{className:"deleted-comment"},"Comment has been deleted"),r.a.createElement("div",{className:"comment-reply-index"},r.a.createElement(ke,{commentId:e.comment._id,videoId:e.videoId})))},De=_.FETCH_VIDEO,Le=(r.a.Component,a(28)),xe=_.FETCH_VIDEO,Ve=le.ADD_VIDEO_LIKE,Te=le.REMOVE_VIDEO_LIKE,Fe=le.ADD_VIDEO_DISLIKE,$e=le.REMOVE_VIDEO_DISLIKE,Ue=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={currentUser:C(),hasLiked:!1},a.hasLiked=a.hasLiked.bind(Object(Le.a)(a)),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleLike",value:function(e,t){var a=this;e.preventDefault(),t({variables:{videoId:this.props.videoId,userId:this.state.currentUser.id}}).then((function(e){a.setState({hasLiked:!0})}))}},{key:"handleRemoveLike",value:function(e,t){var a=this;e.preventDefault(),t({variables:{videoId:this.props.videoId,userId:this.state.currentUser.id}}).then((function(e){a.setState({hasLiked:!1})}))}},{key:"handleDislike",value:function(e,t){var a=this;e.preventDefault(),t({variables:{videoId:this.props.videoId,userId:this.state.currentUser.id}}).then((function(e){a.setState({hasDisliked:!0})}))}},{key:"handleRemoveDislike",value:function(e,t){var a=this;e.preventDefault(),t({variables:{videoId:this.props.videoId,userId:this.state.currentUser.id}}).then((function(e){a.setState({hasDisliked:!1})}))}},{key:"updateCache",value:function(e,t){var a,n=t.data.addVideoLike,r=t.data.removeVideoLike,i=t.data.addVideoDislike,s=t.data.removeVideoDislike;try{a=e.readQuery({query:xe,variables:{id:this.props.videoId}})}catch(f){return}if(a&&n){for(var l=a.video.likes,o=a.video.dislikes,c=0;c<o.length;c++){o[c]._id===n._id&&o.splice(c,1)}a=Object.assign({},a.video,{likes:l.concat(n),dislikes:o}),e.writeQuery({query:xe,variables:{id:this.props.videoId},data:{video:a}})}else if(a&&r){for(var m=a.video.likes,u=0;u<m.length;u++){m[u]._id===r._id&&m.splice(u,1)}a=Object.assign({},a.video,{likes:m}),e.writeQuery({query:xe,variables:{id:this.props.videoId},data:{video:a}})}else if(a&&i){for(var d=a.video.dislikes,v=a.video.likes,p=0;p<v.length;p++){v[p]._id===i._id&&v.splice(p,1)}a=Object.assign({},a.video,{likes:v,dislikes:d.concat(i)}),e.writeQuery({query:xe,variables:{id:this.props.videoId},data:{video:a}})}else if(a&&s){for(var h=a.video.dislikes,E=0;E<h.length;E++){h[E]._id===s._id&&h.splice(E,1)}a=Object.assign({},a.video,{dislikes:h}),e.writeQuery({query:xe,variables:{id:this.props.videoId},data:{video:a}})}this.hasLiked()}},{key:"getLikeCount",value:function(){var e=this.props.likes.length;return 0===e?r.a.createElement("p",null,"No likes"):1===e?r.a.createElement("p",null,"1 like"):r.a.createElement("p",null,e," likes")}},{key:"getDislikeCount",value:function(){var e=this.props.dislikes.length;return 0===e?r.a.createElement("p",null,"No dislikes"):1===e?r.a.createElement("p",null,"1 dislike"):r.a.createElement("p",null,e," dislikes")}},{key:"handleToggle",value:function(e){e.preventDefault();var t=document.getElementById("myPopup");t&&t.classList.toggle("show")}},{key:"hasLiked",value:function(){var e,t,a=this,n=this.props.dislikes,i=this.props.likes;if(!C())return r.a.createElement("div",{className:"popup",onClick:function(e){return a.handleToggle(e)}},r.a.createElement("i",{className:"far fa-thumbs-up unliked-thumb"}),this.getLikeCount(),r.a.createElement("i",{className:"far fa-thumbs-down unliked-thumb"}),this.getLikeCount(),r.a.createElement("div",{class:"popuptext",id:"myPopup"},r.a.createElement(c.b,{className:"like-sign-in",to:"/login"},"Sign in!")));for(var s=0;s<i.length;s++){i[s];if(i[s]._id===this.state.currentUser.id){e=!0;break}e=!1}for(var l=0;l<n.length;l++){n[l];if(n[l]._id===this.state.currentUser.id){t=!0;break}t=!1}return e||t?e&&!t?r.a.createElement("div",{className:"like-bar"},r.a.createElement(V.a,{mutation:Te,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"like-display",onSubmit:function(t){return a.handleRemoveLike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{className:"far fa-thumbs-up liked-thumb"})),a.getLikeCount()))})),r.a.createElement(V.a,{mutation:Fe,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"dislike-display",onSubmit:function(t){return a.handleDislike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{class:"far fa-thumbs-down unliked-thumb"})),a.getDislikeCount()))}))):!e&&t?r.a.createElement("div",{className:"like-bar"},r.a.createElement(V.a,{mutation:Ve,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"like-display",onSubmit:function(t){return a.handleLike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{class:"far fa-thumbs-up unliked-thumb"})),a.getLikeCount()))})),r.a.createElement(V.a,{mutation:$e,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"dislike-display",onSubmit:function(t){return a.handleRemoveDislike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{className:"far fa-thumbs-down liked-thumb"})),a.getDislikeCount()))}))):void 0:r.a.createElement("div",{className:"like-bar"},r.a.createElement(V.a,{mutation:Ve,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"like-display",onSubmit:function(t){return a.handleLike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{class:"far fa-thumbs-up unliked-thumb"})),a.getLikeCount()))})),r.a.createElement(V.a,{mutation:Fe,update:function(e,t){return a.updateCache(e,t)}},(function(e,t){t.data;return r.a.createElement("div",null,r.a.createElement("form",{className:"dislike-display",onSubmit:function(t){return a.handleDislike(t,e)}},r.a.createElement("button",{type:"submit"},r.a.createElement("i",{class:"far fa-thumbs-down unliked-thumb"})),a.getDislikeCount()))})))}},{key:"render",value:function(){return r.a.createElement("div",null,this.hasLiked())}}]),t}(r.a.Component),Re=Object(w.a)(xe)(Ue),qe=_.FETCH_VIDEO,Me=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={currentUser:C(),hasLiked:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(V.b,{query:qe,variables:{id:this.props.videoId}},(function(t){var a=t.loading,n=t.error,i=t.data;if(a)return r.a.createElement("p",null,"Loading...");if(n)return r.a.createElement("p",null,"Error");var s=i.video.likes,l=i.video.dislikes;return r.a.createElement("div",{className:"like-bar"},r.a.createElement(Re,{likes:s,dislikes:l,videoId:e.props.videoId}))}))}}]),t}(r.a.Component),Qe=_.FETCH_VIDEOS,Ae=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderVideos",value:function(){return this.props.data.videos.slice(this.props.data.videos.length-5).map((function(e){var t=e._id,a=e.title,n=e.url;return r.a.createElement("div",{key:t,className:"mini-video-container"},r.a.createElement("div",{className:"mini-vid-player"},r.a.createElement("object",{className:"mini-video-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0}))),r.a.createElement("div",{className:"mini-video-info"},r.a.createElement(c.b,{to:"/videos/".concat(t)},r.a.createElement("p",{className:"mini-video-title clickable"},a))))}))}},{key:"render",value:function(){return this.props.data.loading||!this.props.data.videos?null:r.a.createElement("div",null,r.a.createElement("div",{className:"mini-container"},r.a.createElement("div",{className:"flex-grid"},r.a.createElement("section",{className:"main"},r.a.createElement("p",{className:"mini-index-title"},"Videos For You"),r.a.createElement("div",{className:"col"},this.renderVideos())))))}}]),t}(n.Component),He=Object(w.a)(Qe)(Ae),Pe=_.FETCH_VIDEO,Be=le.VIDEO_COMMENT,Ge=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={text:"",gif:"",error:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){t.setState(Object(K.a)({},e,a.target.value))}}},{key:"handleSubmit",value:function(e,t){var a=this;e.preventDefault();var n=this.state.text,r=this.state.gif;""!==this.state.text?t({variables:{text:n,author:C().id,videoId:this.props.videoId,gif:r}}).then((function(e){a.setState({text:"",gif:"",error:""})})):this.setState({error:"GraphQL error: Cannot return null for non-nullable field CommentType.text."})}},{key:"updateCache",value:function(e,t){var a,n=t.data.addVideoComment;try{a=e.readQuery({query:Pe,variables:{id:this.props.videoId}})}catch(i){return}if(a){var r=a.video.comments;a=Object.assign({},a.video,{comments:r.concat(n)}),e.writeQuery({query:Pe,variables:{id:this.props.videoId},data:{video:a}})}}},{key:"updategif",value:function(e){this.setState({gif:e.downsized.url})}},{key:"render",value:function(){var e,t=this,a=C(),n=a&&a.image?a.image:"/stylesheets/images/default_avatar_2.png";return a?("GraphQL error: Cannot return null for non-nullable field CommentType.text."===this.state.error&&(e="Comment must have text"),r.a.createElement(V.a,{onError:function(e){t.setState({error:e.message})},mutation:Be,update:function(e,a){return t.updateCache(e,a)}},(function(a,i){i.data;return r.a.createElement("div",{className:"create-form"},r.a.createElement("div",{className:"comment-create-position"},r.a.createElement("img",{src:n,className:"comment-create-avatar"}),r.a.createElement("form",{onSubmit:function(e){return t.handleSubmit(e,a)}},r.a.createElement("input",{className:"comment-create-input",value:t.state.text,onChange:t.update("text"),placeholder:"Commenting publicly as ".concat(C().username)}),r.a.createElement("div",null,e),r.a.createElement("button",{className:"create-comment-button",type:"submit"},"COMMENT"))),r.a.createElement("div",{className:"giphy"}," ",r.a.createElement(ce.a,{apiKey:"EeZhW081PZQ2Abce60Y4EQulHVTzcbRA",onSelected:t.updategif.bind(t)})))}))):r.a.createElement("div",{className:"create-form-1"},r.a.createElement("img",{src:n,className:"comment-create-avatar"}),r.a.createElement("input",{className:"comment-create-input-nuser",value:this.state.text,placeholder:"Must Be Signed In to Comment"}))}}]),t}(r.a.Component),Ke=(Object(m.g)(Ge),le.ADD_TO_FAVORITES),Ye=le.REMOVE_FROM_FAVORITES,ze=_.FETCH_VIDEO,Je=_.FETCH_USER_FAVORITE_VIDEOS,Ze=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"handleAddRemoveFavorite",value:function(e,t){e.preventDefault(),t({variables:{videoId:this.props.video._id,userId:C().id}})}},{key:"handleToggle",value:function(e){e.preventDefault();var t=document.getElementById("myPopup");t&&t.classList.toggle("show")}},{key:"renderFavorite",value:function(){var e=this;return C()&&C().id?r.a.createElement(V.a,{mutation:Ke,refetchQueries:function(){return[{query:ze,variables:{id:e.props.video._id}},{query:Je,variables:{id:C().id}}]}},(function(t,a){var n=a.loading,i=a.error;a.data;return n?r.a.createElement("i",{class:"fas fa-spinner"}):i?r.a.createElement("p",null,"Error :( Please try again"):r.a.createElement("i",{className:"far fa-heart",style:{cursor:"pointer"},onClick:function(a){return e.handleAddRemoveFavorite(a,t)}})})):r.a.createElement("div",{className:"popup",onClick:function(t){return e.handleToggle(t)}},r.a.createElement("i",{className:"fas far fa-heart"}),r.a.createElement("div",{className:"popuptext",id:"myPopup"},r.a.createElement(c.b,{className:"like-sign-in",to:"/login"},"Sign in!")))}},{key:"renderUnFavorite",value:function(){var e=this;return r.a.createElement(V.a,{mutation:Ye,refetchQueries:function(){return[{query:ze,variables:{id:e.props.video._id}}]}},(function(t,a){var n=a.loading,i=a.error;a.data;return n?r.a.createElement("i",{class:"fas fa-spinner"}):i?r.a.createElement("p",null,"Error :( Please try again"):r.a.createElement("i",{className:"fas fa-heart fav-heart",style:{cursor:"pointer"},onClick:function(a){return e.handleAddRemoveFavorite(a,t)}})}))}},{key:"render",value:function(){var e=[];if(C()&&C().id){var t=C().id;e=this.props.video.favoriteBy.filter((function(e){return e._id.toString()===t}))}return r.a.createElement(r.a.Fragment,null,0===e.length?this.renderFavorite():this.renderUnFavorite())}}]),t}(n.Component),We=_.FETCH_VIDEO_LIKES,Xe=_.FETCH_VIDEO,et=function(e){function t(){return Object(u.a)(this,t),Object(v.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderVideoDetail",value:function(){var e=this.props.data.video,t=e._id,a=e.title,n=e.url,i=e.description,s=e.comments,l=e.favoriteBy;return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"video-detail-main"},r.a.createElement("div",{className:"detail-left-col"},r.a.createElement("object",{className:"video-detail-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0})),r.a.createElement("div",{className:"video-title-detail"},r.a.createElement("h3",null,a)),r.a.createElement("div",{className:"video-info-detail"},r.a.createElement("div",{className:"detail-comments-favs"},r.a.createElement("p",null,s.length," ",r.a.createElement("i",{class:"far fa-comments"})),r.a.createElement("p",{className:"video-fav-detail"},l.length," ",r.a.createElement(Ze,{video:this.props.data.video}))),r.a.createElement("div",{className:"rate-likes"},r.a.createElement(Me,{videoId:this.props.data.video._id,video:this.props.data.video}))),r.a.createElement("div",{className:"video-description-detail"},r.a.createElement("p",{className:"video-description-body"},i))),r.a.createElement(He,{className:"mini-index"})))}},{key:"updateCache",value:function(e,t){var a,n=t.data.newLike;try{a=e.readQuery({query:We,variables:{id:this.props.data.video._id}})}catch(i){return}if(a){var r=a.likes;e.writeQuery({query:We,data:{likes:r.concat(n)}})}}},{key:"render",value:function(){return this.props.data.loading||!this.props.data.video?null:r.a.createElement("div",null,r.a.createElement(H,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"flex-grid"},r.a.createElement(x,null),r.a.createElement(L,null),r.a.createElement("section",{className:"detail-main"},r.a.createElement("div",{className:"row"},this.renderVideoDetail())))))}}]),t}(r.a.Component),tt=Object(w.a)(Xe,{options:function(e){return{variables:{id:e.match.params.id}}}})(et),at=le.REGISTER_USER,nt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).updateImage=function(e){if(0!==e.target.files.length){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){a.setState({image:n.result})},n.readAsDataURL(t)}},a.state={username:"",email:"",password:"",password2:"",image:"/stylesheets/images/default_avatar_2.png",error:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){return t.setState(Object(K.a)({},e,a.target.value))}}},{key:"updateCache",value:function(e,t){var a=t.data;e.writeData({data:{isLoggedIn:a.register.loggedIn}})}},{key:"render",value:function(){var e,t=this,a="dark"===localStorage.theme?window.darkTheme:window.lightTheme;return"please fill in missing fields"===this.state.error?e="Please fill in missing fields":"GraphQL error: Email is invalid"===this.state.error?e="Invalid email":"GraphQL error: This user already exists"===this.state.error?e="User already exists":"GraphQL error: This username already exists"===this.state.error?e="Username already exists":"GraphQL error: Passwords do not match"===this.state.error&&(e="Passwords do not match"),r.a.createElement(V.a,{onError:function(e){t.setState({error:e.message})},mutation:at,onCompleted:function(e){var t=e.register,a=t.token,n=t._id,r=t.username,i=t.image,s=t.email;localStorage.setItem("auth-token",a),localStorage.setItem("user",JSON.stringify({id:n,username:r,image:i,email:s}))},update:function(e,a){return t.updateCache(e,a)}},(function(n){return r.a.createElement("div",{className:"sign-up-form-page"},r.a.createElement("form",{className:"sign-up-form",onSubmit:function(e){e.preventDefault(),""!==t.state.password&&""!==t.state.username&&""!==t.state.email&&""!==t.state.password2?n({variables:{username:t.state.username,email:t.state.email,password:t.state.password,password2:t.state.password2,image:t.state.image}}):t.setState({error:"please fill in missing fields"})}},r.a.createElement(c.b,{to:"/"},r.a.createElement("img",{className:"signup-logo",src:a,alt:"signup"})),r.a.createElement("p",{className:"form-title"},"Create your PalTube Account"),r.a.createElement("div",null,e),r.a.createElement("input",{value:t.state.username,onChange:t.update("username"),placeholder:"Username",className:"signup-username"}),r.a.createElement("input",{value:t.state.email,onChange:t.update("email"),placeholder:"Email",className:"signup-email"}),r.a.createElement("input",{value:t.state.password,onChange:t.update("password"),type:"password",placeholder:"Password",className:"signup-password"}),r.a.createElement("input",{value:t.state.password2,onChange:t.update("password2"),type:"password",placeholder:"Confirm",className:"signup-password2"}),r.a.createElement("input",{type:"file",onChange:t.updateImage,className:"signup-password2"}),r.a.createElement("div",{className:"signup-direct"},r.a.createElement(c.b,{to:"/login",className:"link-login"},"Sign in instead"),r.a.createElement("button",{type:"submit",className:"signup-button"},"Sign up"))),r.a.createElement("div",{className:"signup-pic"},r.a.createElement("img",{src:t.state.image,className:"signup-avatar"}),r.a.createElement("img",{src:"/stylesheets/images/signuppic.png",alt:"signup"}),r.a.createElement("p",{className:"signup-pic-info"},"Join. Watch. Laugh.")))}))}}]),t}(n.Component),rt=le.LOGIN_USER,it=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).state={emailOrUsername:"",password:"",error:""},a.handleDemoSubmit=a.handleDemoSubmit.bind(Object(Le.a)(a)),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"update",value:function(e){var t=this;return function(a){return t.setState(Object(K.a)({},e,a.target.value))}}},{key:"demoEffect",value:function(e,t){var a=this,n=this,r=0,i=setInterval((function(){r<e.emailOrUsername.length&&n.setState({emailOrUsername:a.state.emailOrUsername+e.emailOrUsername[r]}),r<e.password.length&&n.setState({password:a.state.password+e.password[r]}),++r>e.password.length&&r>e.emailOrUsername.length&&(clearInterval(i),t({variables:e}).then((function(){return a.props.history.push("/")})))}),200)}},{key:"handleDemoSubmit",value:function(e,t){e.preventDefault();this.demoEffect({emailOrUsername:"GuestUser",password:"password"},t)}},{key:"updateCache",value:function(e,t){var a=t.data;e.writeData({data:{isLoggedIn:a.login.loggedIn}})}},{key:"render",value:function(){var e,t=this,a="dark"===localStorage.theme?window.darkTheme:window.lightTheme;return"password and username is required"===this.state.error?e="password and username is required":"password is required"===this.state.error?e="password is required":"username is required"===this.state.error?e="username is required":"GraphQL error: Incorrect log in combination"===this.state.error&&(e="Incorrect log in combination"),r.a.createElement(V.a,{onError:function(e){t.setState({error:e.message})},mutation:rt,onCompleted:function(e){var a=e.login,n=a.token,r=a._id,i=a.username,s=a.image,l=a.email;localStorage.setItem("auth-token",n),localStorage.setItem("user",JSON.stringify({id:r,username:i,image:s,email:l})),t.props.history.push("/")},update:function(e,a){return t.updateCache(e,a)}},(function(n){return r.a.createElement("div",{className:"login-form-page"},r.a.createElement("div",{className:"login-pic"},r.a.createElement("img",{src:"/stylesheets/images/loginpic.png",alt:"login"}),r.a.createElement("p",{className:"login-pic-info"},"Welcome back to PalTube!")),r.a.createElement("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),""!==t.state.password||""!==t.state.emailOrUsername?""!==t.state.password?""!==t.state.emailOrUsername?n({variables:{emailOrUsername:t.state.emailOrUsername,password:t.state.password}}):t.setState({error:"username is required"}):t.setState({error:"password is required"}):t.setState({error:"password and username is required"})}},r.a.createElement(c.b,{to:"/"},r.a.createElement("img",{className:"login-logo",src:a,alt:"login"})),r.a.createElement("p",{className:"form-title"},"Sign into your account"),r.a.createElement("div",null,e),r.a.createElement("input",{value:t.state.emailOrUsername,onChange:t.update("emailOrUsername"),placeholder:"Email or Username",className:"login-email"}),r.a.createElement("input",{value:t.state.password,onChange:t.update("password"),type:"password",placeholder:"Password",className:"login-password"}),r.a.createElement("div",{className:"login-direct"},r.a.createElement("button",{type:"submit",className:"login-button"},"Sign In"),r.a.createElement("button",{onClick:function(e){return t.handleDemoSubmit(e,n)},type:"submit",className:"demo-button"},"Guest User")),r.a.createElement(c.b,{to:"/register",className:"link-signup"},"Sign up instead")))}))}}]),t}(n.Component),st=a(49),lt=_.IS_LOGGED_IN,ot=function(e){var t=e.component,a=e.path,n=e.exact,i=e.routeType,s=Object(st.a)(e,["component","path","exact","routeType"]);return r.a.createElement(V.b,{query:lt},(function(e){var l=e.data;return"auth"===i?r.a.createElement(m.b,{path:a,exact:n,render:function(e){return l.isLoggedIn?r.a.createElement(m.a,{to:"/"}):r.a.createElement(t,e)}}):r.a.createElement(m.b,Object.assign({},s,{render:function(e){return l.isLoggedIn?r.a.createElement(t,e):r.a.createElement(m.a,{to:"/login"})}}))}))},ct=_.FETCH_VIDEOS,mt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).renderSearchResult=function(){var e=a.props.match.params.criteria;return r.a.createElement(V.b,{query:ct,variables:{criteria:e},onCompleted:function(e){return a.setState({videosLength:e.videos.length})}},(function(e){var t=e.loading,a=e.error,n=e.data;return t?"Loading...":a?"Error! ".concat(a.message):n.videos.map((function(e){var t=e._id,a=e.title,n=e.url,i=e.description,s=e.comments,l=e.favoriteBy;return r.a.createElement("div",{className:"search-results-container",key:t},r.a.createElement("div",{className:"video-detail-container "},r.a.createElement("object",{className:"video-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0}))),r.a.createElement("div",{className:"video-detail-info-container"},r.a.createElement(c.b,{to:"/videos/".concat(t)},r.a.createElement("p",{className:"clickable"},a)),r.a.createElement("p",null,i),r.a.createElement("p",null,s.length," ",r.a.createElement("i",{class:"far fa-comments"})),r.a.createElement("p",null,l.length," ",r.a.createElement("i",{class:"fas fa-heart"}))))}))}))},a.state={videosLength:0},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement(H,null),r.a.createElement("div",{className:"flex-grid"},r.a.createElement(L,null),r.a.createElement("section",{className:"main"},r.a.createElement("div",null,r.a.createElement("h5",null,"we found ",this.state.videosLength," videos matches your search..."),this.renderSearchResult()))))}}]),t}(n.Component),ut=_.FETCH_USER_LIKED_VIDEOS,dt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).renderVideos=function(){var e=C().id;return r.a.createElement(V.b,{query:ut,variables:{id:e},onCompleted:function(e){return a.setState({videosLength:e.user.videos_liked.length})}},(function(e){var t=e.loading,a=e.error,n=e.data;return t?"Loading...":a?"Error! ".concat(a.message):n.user.videos_liked.map((function(e){var t=e._id,a=e.title,n=e.url,i=e.description,s=e.comments,l=e.favoriteBy;return r.a.createElement("div",{className:"search-results-container",key:t},r.a.createElement("div",{className:"video-detail-container "},r.a.createElement("object",{className:"video-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0}))),r.a.createElement("div",{className:"video-detail-info-container"},r.a.createElement(c.b,{to:"/videos/".concat(t)},r.a.createElement("p",{className:"clickable"},a)),r.a.createElement("p",null,i),r.a.createElement("p",null,s.length," ",r.a.createElement("i",{class:"far fa-comments"})),r.a.createElement("p",null,l.length," ",r.a.createElement("i",{class:"fas fa-heart"}))))}))}))},a.state={videosLength:0},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return C()||this.props.history.push("/login"),r.a.createElement("div",{className:"container"},r.a.createElement(H,null),r.a.createElement("div",{className:"flex-grid"},r.a.createElement(x,null),r.a.createElement(L,null),r.a.createElement("section",{className:"main"},r.a.createElement("div",null,r.a.createElement("h5",null,"you have liked ",this.state.videosLength," videos..."),this.renderVideos()))))}}]),t}(n.Component),vt=_.FETCH_USER_FAVORITE_VIDEOS,pt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(v.a)(this,Object(p.a)(t).call(this,e))).renderVideos=function(){var e=C().id;return r.a.createElement(V.b,{query:vt,variables:{id:e},onCompleted:function(e){return a.setState({videosLength:e.user.favoriteVideos.length})}},(function(e){var t=e.loading,a=e.error,n=e.data;return t?"Loading...":a?"Error! ".concat(a.message):n.user.favoriteVideos.map((function(e){var t=e._id,a=e.title,n=e.url,i=e.description,s=e.comments,l=e.favoriteBy;return r.a.createElement("div",{className:"search-results-container",key:t},r.a.createElement("div",{className:"video-detail-container "},r.a.createElement("object",{className:"video-player"},r.a.createElement("param",{name:"movie",value:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US;showinfo=0")}),r.a.createElement("param",{name:"allowFullScreen",value:"true"}),r.a.createElement("param",{name:"allowscriptaccess",value:"always"}),r.a.createElement("embed",{src:"".concat(n,"?modestbranding=1&amp;version=3&amp;hl=en_US&amp;showinfo=0"),type:"application/x-shockwave-flash",className:"video-player",allowscriptaccess:"always",allowFullScreen:!0}))),r.a.createElement("div",{className:"video-detail-info-container"},r.a.createElement(c.b,{to:"/videos/".concat(t)},r.a.createElement("p",{className:"clickable"},a)),r.a.createElement("p",null,i),r.a.createElement("p",null,s.length," ",r.a.createElement("i",{class:"far fa-comments"})),r.a.createElement("p",null,l.length," ",r.a.createElement("i",{class:"fas fa-heart"}))))}))}))},a.state={videosLength:0},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return C()||this.props.history.push("/login"),r.a.createElement("div",{className:"container"},r.a.createElement(H,null),r.a.createElement("div",{className:"flex-grid"},r.a.createElement(x,null),r.a.createElement(L,null),r.a.createElement("section",{className:"main"},r.a.createElement("div",null,r.a.createElement("h5",null,"you have ",this.state.videosLength," favorite videos ... "),this.renderVideos()))))}}]),t}(n.Component),ht=function(){return r.a.createElement("div",null,r.a.createElement(m.d,null,r.a.createElement(ot,{path:"/register",component:nt,routeType:"auth"}),r.a.createElement(m.b,{exact:!0,path:"/",component:G}),r.a.createElement(m.b,{exact:!0,path:"/videos/likes",component:dt}),r.a.createElement(m.b,{exact:!0,path:"/videos/favorites",component:pt}),r.a.createElement(m.b,{path:"/videos/:id",component:tt}),r.a.createElement(m.b,{path:"/search/:criteria",component:mt}),r.a.createElement(ot,{path:"/login",component:it,routeType:"auth"})))},Et=a(51),ft=a(52),gt=a(50),bt=a(18),yt=le.VERIFY_USER,kt=localStorage.getItem("auth-token"),It=new Et.a({dataIdFromObject:function(e){return e._id||null}}),Ot=Object(ft.a)({credentials:"same-origin"}),Nt=Object(gt.a)((function(e){var t=e.graphQLErrors;t&&t.map((function(e){var t=e.message;return console.log(t)}))})),St=new l.c({link:bt.a.from([Nt,Ot]),cache:It,headers:{authorization:localStorage.getItem("auth-token")},onError:function(e){var t=e.networkError,a=e.graphQLErrors;console.log("graphQLErrors",a),console.log("networkError",t)}});It.writeData({data:{isLoggedIn:Boolean(kt)}}),kt&&St.mutate({mutation:yt,variables:{token:kt}}).then((function(e){var t=e.data;It.writeData({data:{isLoggedIn:t.verifyUser.loggedIn}})}));s.a.render(r.a.createElement((function(){return r.a.createElement(o.b,{client:St},r.a.createElement(c.a,null,r.a.createElement(ht,null)))}),null),document.querySelector("#root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.bd0bae4a.chunk.js.map